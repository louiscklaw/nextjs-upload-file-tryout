"use strict";(self.webpackChunkdoc=self.webpackChunkdoc||[]).push([[27114],{26499:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>u,frontMatter:()=>d,metadata:()=>a,toc:()=>o});var r=i(74848),s=i(28453),t=i(70344);const d={title:"Android Build Stacks",description:"Learn about the Android build stacks in Appcircle",tags:["build","android","build stacks"],sidebar_position:2},l="Android Build Stacks",a={id:"infrastructure/android-build-infrastructure",title:"Android Build Stacks",description:"Learn about the Android build stacks in Appcircle",source:"@site/docs/080_infrastructure/android-build-infrastructure.md",sourceDirName:"080_infrastructure",slug:"/infrastructure/android-build-infrastructure",permalink:"/nextjs-upload-file-tryout/infrastructure/android-build-infrastructure",draft:!1,unlisted:!1,editUrl:"https://github.com/appcircleio/appcircle-docusaurus/tree/master/docs/080_infrastructure/android-build-infrastructure.md",tags:[{label:"build",permalink:"/nextjs-upload-file-tryout/tags/build"},{label:"android",permalink:"/nextjs-upload-file-tryout/tags/android"},{label:"build stacks",permalink:"/nextjs-upload-file-tryout/tags/build-stacks"}],version:"current",sidebarPosition:2,frontMatter:{title:"Android Build Stacks",description:"Learn about the Android build stacks in Appcircle",tags:["build","android","build stacks"],sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"iOS Build Stacks",permalink:"/nextjs-upload-file-tryout/infrastructure/ios-build-infrastructure"},next:{title:"Marketplace Overview",permalink:"/nextjs-upload-file-tryout/marketplace/"}},c={},o=[{value:"Java Version",id:"java-version",level:2},{value:"Emulator",id:"emulator",level:2},{value:"Android Build Agent Stacks",id:"android-build-agent-stacks",level:2},{value:"Using your own computer for build",id:"using-your-own-computer-for-build",level:3}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"android-build-stacks",children:"Android Build Stacks"}),"\n",(0,r.jsx)(n.p,{children:"For each Android build, Appcircle creates a brand new virtual machine;"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:'If you select "Default Intel Pool", virtual machine will be Debian 11 Bullseye.'}),"\n",(0,r.jsxs)(n.li,{children:['If you select "Default M1 Pool", virtual machine will be macOS Sonoma ',(0,r.jsx)(n.code,{children:"14.1"})," or macOS Monterey ",(0,r.jsx)(n.code,{children:"12.6"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.admonition,{type:"info",children:[(0,r.jsx)(n.p,{children:"If you select M1 Pool, you can not choose macOS version. It will be automatically selected by Appcircle."}),(0,r.jsx)(n.p,{children:"The chance is equal for both macOS Sonoma and macOS Monterey for your android build because it does not effect your build."})]}),"\n",(0,r.jsx)(n.p,{children:"Virtual machines are created and they become ready for build within seconds."}),"\n",(0,r.jsx)(n.p,{children:"During the build process, you can install any dependencies and run commands using custom script steps in the build workflow. This gives you complete control over your build and the virtual machine."}),"\n",(0,r.jsx)(n.admonition,{type:"info",children:(0,r.jsx)(n.p,{children:"Please note that virtual machines are wiped off after a build is executed (no matter success or fail) and anything you installed in the virtual machine will be gone."})}),"\n",(0,r.jsx)(n.h2,{id:"java-version",children:"Java Version"}),"\n",(0,r.jsx)(n.p,{children:"Build agents have Java 8, 11, 17 and 21 installed. Java 11 is set as the default version."}),"\n",(0,r.jsxs)(n.p,{children:["If you want to use a different Java version, please follow ",(0,r.jsx)(n.a,{href:"/workflows/common-workflow-steps/custom-script#how-to-change-java-version",children:"this document"})," for how to do that."]}),"\n",(0,r.jsx)(n.p,{children:'When you select "Default Intel Pool" for Android builds, the following JDK locations are available within the environment variables:'}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"JAVA_HOME_8_X64"}),": ",(0,r.jsx)(n.code,{children:"/usr/local/openjdk-8"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"JAVA_HOME_11_X64"}),": ",(0,r.jsx)(n.code,{children:"/root/.sdkman/candidates/java/11.0.12-open"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"JAVA_HOME_17_X64"}),": -"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"JAVA_HOME_21_X64"}),": -"]}),"\n"]}),"\n",(0,r.jsxs)(n.admonition,{type:"caution",children:[(0,r.jsx)(n.p,{children:"We're deprecating Intel-based runners and transitioning our customers to Apple silicon (M1)-based build machines."}),(0,r.jsx)(n.p,{children:'Currently, JDK 17 and 21 are not pre-installed on the "Default Intel Pool", and Intel-based runners are not actively maintained.'}),(0,r.jsx)(n.p,{children:'If your app does not specifically require an Intel-based build machine, we suggest you use "Default M1 Pool", since it has much more build capacity and the latest updates.'})]}),"\n",(0,r.jsx)(n.p,{children:'When you select "Default M1 Pool" for Android builds, the following JDK locations are available within the environment variables:'}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"JAVA_HOME_8_X64"}),": ",(0,r.jsx)(n.code,{children:"/Users/appcircle/.sdkman/candidates/java/8.0.392-zulu"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"JAVA_HOME_11_X64"}),": ",(0,r.jsx)(n.code,{children:"/Users/appcircle/.sdkman/candidates/java/11.0.21-zulu"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"JAVA_HOME_17_X64"}),": ",(0,r.jsx)(n.code,{children:"/Users/appcircle/.sdkman/candidates/java/17.0.9-zulu"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"JAVA_HOME_21_X64"}),": ",(0,r.jsx)(n.code,{children:"/Users/appcircle/.sdkman/candidates/java/21.0.2-zulu"})]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"emulator",children:"Emulator"}),"\n",(0,r.jsxs)(n.p,{children:["Build agents have Pixel_3a Android 9.0 emulator pre-installed. You may add or remove other emulators by using ",(0,r.jsx)(n.code,{children:"sdkmanager"}),".\nFor example, in order to install Android 11 (API 30) emulator to x86_64 Linux, you can take the below steps:"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"1."})," Install emulator system image if not exists. (If it exists, the command will return quickly with success.)"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'sdkmanager "system-images;android-30;google_apis;x86_64"\n'})}),"\n",(0,r.jsx)(n.p,{children:"You can see a list of available system images with the below command:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'sdkmanager --list | grep "system-images;android"\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"2."}),' Create new pixel_3a device with "Pixel_Custom" emulator name.']}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'avdmanager create avd -n Pixel_Custom -k "system-images;android-30;google_apis;x86_64" -c 512M -d pixel_3a\n'})}),"\n",(0,r.jsxs)(n.p,{children:["When completed with success, you should see below the device with ",(0,r.jsx)(n.code,{children:"avdmanager list avd"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-txt",children:"    Name: Pixel_Custom\n  Device: pixel_3a (Google)\n    Path: /users/appcircle/.android/avd/Pixel_Custom.avd\n  Target: Google APIs (Google Inc.)\nBased on: Android 11.0 (R)\n Tag/ABI: google_apis/x86_64\n  Sdcard: 512 MB\n"})}),"\n",(0,r.jsx)(n.admonition,{type:"caution",children:(0,r.jsxs)(n.p,{children:["If you're using UI tests with emulators, you must select an Intel device (",(0,r.jsx)(n.strong,{children:"Default Intel Pool"}),") since M1 virtual machines (",(0,r.jsx)(n.strong,{children:"Default M1 Pool"}),") don't support nested virtualization."]})}),"\n",(0,r.jsx)(n.h2,{id:"android-build-agent-stacks",children:"Android Build Agent Stacks"}),"\n",(0,r.jsx)(n.p,{children:"There are many pre-installed packages in virtual machines. You can get a full list of pre-installed packages by running Bash commands in custom script steps."}),"\n",(0,r.jsx)(n.p,{children:"Here are some most important packages installed in our Linux and macOS images used for Android builds:"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Package"}),(0,r.jsx)(n.th,{children:"Debian Bullseye"}),(0,r.jsx)(n.th,{children:"M1 Pool Sonoma"}),(0,r.jsx)(n.th,{children:"\xa0M1 Pool Monterey"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Apt Package Manager"}),(0,r.jsx)(n.td,{children:"2.2.4"}),(0,r.jsx)(n.td,{children:"n/A"}),(0,r.jsx)(n.td,{children:"n/A"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Bash"}),(0,r.jsx)(n.td,{children:"5.1.4"}),(0,r.jsx)(n.td,{children:"3.2.57"}),(0,r.jsx)(n.td,{children:"3.2.57"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"GNU Binutils"}),(0,r.jsx)(n.td,{children:"2.35.2"}),(0,r.jsx)(n.td,{children:"2.41"}),(0,r.jsx)(n.td,{children:"2.39"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Bzip2"}),(0,r.jsx)(n.td,{children:"1.0.8"}),(0,r.jsx)(n.td,{children:"n/A"}),(0,r.jsx)(n.td,{children:"n/A"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Curl"}),(0,r.jsx)(n.td,{children:"7.74.0"}),(0,r.jsx)(n.td,{children:"8.1.2"}),(0,r.jsx)(n.td,{children:"7.79.1"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"GCC"}),(0,r.jsx)(n.td,{children:"10.2.1"}),(0,r.jsx)(n.td,{children:"15.0.0"}),(0,r.jsx)(n.td,{children:"14.0.0"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Git"}),(0,r.jsx)(n.td,{children:"2.35.1"}),(0,r.jsx)(n.td,{children:"2.43.2"}),(0,r.jsx)(n.td,{children:"2.38.1"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Git LFS"}),(0,r.jsx)(n.td,{children:"2.13.2"}),(0,r.jsx)(n.td,{children:"3.4.1"}),(0,r.jsx)(n.td,{children:"3.2.0"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Gradle"}),(0,r.jsx)(n.td,{children:"4.4.1"}),(0,r.jsx)(n.td,{children:"8.6"}),(0,r.jsx)(n.td,{children:"7.5.1"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Gzip"}),(0,r.jsx)(n.td,{children:"1.10.4"}),(0,r.jsx)(n.td,{children:"428"}),(0,r.jsx)(n.td,{children:"353.100.22"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Java"}),(0,r.jsx)(n.td,{children:"11.0.12"}),(0,r.jsx)(n.td,{children:"11.0.21"}),(0,r.jsx)(n.td,{children:"11.0.21"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Maven"}),(0,r.jsx)(n.td,{children:"3.8.6"}),(0,r.jsx)(n.td,{children:"3.9.6"}),(0,r.jsx)(n.td,{children:"3.8.6"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Node JS"}),(0,r.jsx)(n.td,{children:"16.18.1"}),(0,r.jsx)(n.td,{children:"18.19.1"}),(0,r.jsx)(n.td,{children:"18.19.1"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"OpenSSL"}),(0,r.jsx)(n.td,{children:"1.1.1"}),(0,r.jsx)(n.td,{children:"3.3.6"}),(0,r.jsx)(n.td,{children:"2.8.3"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Perl"}),(0,r.jsx)(n.td,{children:"5.32.1"}),(0,r.jsx)(n.td,{children:"5.30.3"}),(0,r.jsx)(n.td,{children:"5.30.3"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Python"}),(0,r.jsx)(n.td,{children:"3.9.2"}),(0,r.jsx)(n.td,{children:"3.11.7"}),(0,r.jsx)(n.td,{children:"3.10.8"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Rake"}),(0,r.jsx)(n.td,{children:"13.0.6"}),(0,r.jsx)(n.td,{children:"13.0.6"}),(0,r.jsx)(n.td,{children:"13.0.1"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Rbenv"}),(0,r.jsx)(n.td,{children:"1.2.0"}),(0,r.jsx)(n.td,{children:"1.2.0"}),(0,r.jsx)(n.td,{children:"1.2.0"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Ruby"}),(0,r.jsx)(n.td,{children:"2.7.5"}),(0,r.jsx)(n.td,{children:"3.2.3"}),(0,r.jsx)(n.td,{children:"2.7.5"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Unzip"}),(0,r.jsx)(n.td,{children:"6.00"}),(0,r.jsx)(n.td,{children:"6.00"}),(0,r.jsx)(n.td,{children:"6.00"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Wget"}),(0,r.jsx)(n.td,{children:"1.21"}),(0,r.jsx)(n.td,{children:"1.21.4"}),(0,r.jsx)(n.td,{children:"1.21"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Yarn"}),(0,r.jsx)(n.td,{children:"1.22.19"}),(0,r.jsx)(n.td,{children:"1.22.19"}),(0,r.jsx)(n.td,{children:"1.22.19"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Zip"}),(0,r.jsx)(n.td,{children:"3.0"}),(0,r.jsx)(n.td,{children:"3.0"}),(0,r.jsx)(n.td,{children:"3.0"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"using-your-own-computer-for-build",children:"Using your own computer for build"}),"\n",(0,r.jsx)(n.p,{children:"Appcircle supports using a third-party computer to perform builds. You can create your own build environment by installing the operating system and other tools and dependencies you need to tell Appcircle to use that environment to perform builds."}),"\n",(0,r.jsx)(t.A,{url:"/self-hosted-appcircle/self-hosted-runner",children:(0,r.jsx)(n.p,{children:"Appcircle Self-hosted Runner"})})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},70344:(e,n,i)=>{i.d(n,{A:()=>c});var r,s,t=i(96540);function d(){return d=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var r in i)({}).hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},d.apply(null,arguments)}const l=e=>{let{title:n,titleId:i,...l}=e;return t.createElement("svg",d({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-file-text","aria-labelledby":i},l),n?t.createElement("title",{id:i},n):null,r||(r=t.createElement("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"})),s||(s=t.createElement("path",{d:"M14 2v6h6M16 13H8M16 17H8M10 9H8"})))};var a=i(74848);function c(e){let{children:n,url:i}=e;return(0,a.jsxs)("a",{href:i,className:"content-ref-card",children:[(0,a.jsx)(l,{title:"File Icon",className:"file-icon"}),n]})}},28453:(e,n,i)=>{i.d(n,{R:()=>d,x:()=>l});var r=i(96540);const s={},t=r.createContext(s);function d(e){const n=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:d(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);